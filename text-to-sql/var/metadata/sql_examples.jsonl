{"question": "Show sample ADMISSIONS rows with SUBJECT_ID and HADM_ID", "sql": "SELECT SUBJECT_ID, HADM_ID FROM ADMISSIONS WHERE SUBJECT_ID IS NOT NULL AND ROWNUM <= 100"}
{"question": "Count rows in ADMISSIONS (sampled)", "sql": "SELECT COUNT(*) AS cnt FROM ADMISSIONS WHERE ROWNUM <= 1000"}
{"question": "List distinct values of SUBJECT_ID in ADMISSIONS (sample)", "sql": "SELECT DISTINCT SUBJECT_ID FROM ADMISSIONS WHERE SUBJECT_ID IS NOT NULL AND ROWNUM <= 50"}
{"question": "Show sample CAREGIVER rows with CAREGIVER_ID", "sql": "SELECT CAREGIVER_ID FROM CAREGIVER WHERE CAREGIVER_ID IS NOT NULL AND ROWNUM <= 100"}
{"question": "Count rows in CAREGIVER (sampled)", "sql": "SELECT COUNT(*) AS cnt FROM CAREGIVER WHERE ROWNUM <= 1000"}
{"question": "List distinct values of CAREGIVER_ID in CAREGIVER (sample)", "sql": "SELECT DISTINCT CAREGIVER_ID FROM CAREGIVER WHERE CAREGIVER_ID IS NOT NULL AND ROWNUM <= 50"}
{"question": "Show sample CHARTEVENTS rows with SUBJECT_ID and HADM_ID", "sql": "SELECT SUBJECT_ID, HADM_ID FROM CHARTEVENTS WHERE SUBJECT_ID IS NOT NULL AND ROWNUM <= 100"}
{"question": "Count rows in CHARTEVENTS (sampled)", "sql": "SELECT COUNT(*) AS cnt FROM CHARTEVENTS WHERE ROWNUM <= 1000"}
{"question": "List distinct values of SUBJECT_ID in CHARTEVENTS (sample)", "sql": "SELECT DISTINCT SUBJECT_ID FROM CHARTEVENTS WHERE SUBJECT_ID IS NOT NULL AND ROWNUM <= 50"}
{"question": "Show sample DATETIMEEVENTS rows with SUBJECT_ID and HADM_ID", "sql": "SELECT SUBJECT_ID, HADM_ID FROM DATETIMEEVENTS WHERE SUBJECT_ID IS NOT NULL AND ROWNUM <= 100"}
{"question": "Count rows in DATETIMEEVENTS (sampled)", "sql": "SELECT COUNT(*) AS cnt FROM DATETIMEEVENTS WHERE ROWNUM <= 1000"}
{"question": "List distinct values of SUBJECT_ID in DATETIMEEVENTS (sample)", "sql": "SELECT DISTINCT SUBJECT_ID FROM DATETIMEEVENTS WHERE SUBJECT_ID IS NOT NULL AND ROWNUM <= 50"}
{"question": "Show sample DIAGNOSES_ICD rows with SUBJECT_ID and HADM_ID", "sql": "SELECT SUBJECT_ID, HADM_ID FROM DIAGNOSES_ICD WHERE SUBJECT_ID IS NOT NULL AND ROWNUM <= 100"}
{"question": "Count rows in DIAGNOSES_ICD (sampled)", "sql": "SELECT COUNT(*) AS cnt FROM DIAGNOSES_ICD WHERE ROWNUM <= 1000"}
{"question": "Show sample D_ICD_DIAGNOSES rows with ICD_CODE and ICD_VERSION", "sql": "SELECT ICD_CODE, ICD_VERSION FROM D_ICD_DIAGNOSES WHERE ICD_CODE IS NOT NULL AND ROWNUM <= 100"}
{"question": "Count rows in D_ICD_DIAGNOSES (sampled)", "sql": "SELECT COUNT(*) AS cnt FROM D_ICD_DIAGNOSES WHERE ROWNUM <= 1000"}
{"question": "Show sample D_ICD_PROCEDURES rows with ICD_CODE and ICD_VERSION", "sql": "SELECT ICD_CODE, ICD_VERSION FROM D_ICD_PROCEDURES WHERE ICD_CODE IS NOT NULL AND ROWNUM <= 100"}
{"question": "Count rows in D_ICD_PROCEDURES (sampled)", "sql": "SELECT COUNT(*) AS cnt FROM D_ICD_PROCEDURES WHERE ROWNUM <= 1000"}
{"question": "Show sample D_ITEMS rows with ITEMID and LABEL", "sql": "SELECT ITEMID, LABEL FROM D_ITEMS WHERE ITEMID IS NOT NULL AND ROWNUM <= 100"}
{"question": "Count rows in D_ITEMS (sampled)", "sql": "SELECT COUNT(*) AS cnt FROM D_ITEMS WHERE ROWNUM <= 1000"}
{"question": "Show sample D_LABITEMS rows with ITEMID and LABEL", "sql": "SELECT ITEMID, LABEL FROM D_LABITEMS WHERE ITEMID IS NOT NULL AND ROWNUM <= 100"}
{"question": "Count rows in D_LABITEMS (sampled)", "sql": "SELECT COUNT(*) AS cnt FROM D_LABITEMS WHERE ROWNUM <= 1000"}
{"question": "Show sample EMAR rows with SUBJECT_ID and HADM_ID", "sql": "SELECT SUBJECT_ID, HADM_ID FROM EMAR WHERE SUBJECT_ID IS NOT NULL AND ROWNUM <= 100"}
{"question": "Count rows in EMAR (sampled)", "sql": "SELECT COUNT(*) AS cnt FROM EMAR WHERE ROWNUM <= 1000"}
{"question": "Show sample EMAR_DETAIL rows with SUBJECT_ID and EMAR_ID", "sql": "SELECT SUBJECT_ID, EMAR_ID FROM EMAR_DETAIL WHERE SUBJECT_ID IS NOT NULL AND ROWNUM <= 100"}
{"question": "Count rows in EMAR_DETAIL (sampled)", "sql": "SELECT COUNT(*) AS cnt FROM EMAR_DETAIL WHERE ROWNUM <= 1000"}
{"question": "Show sample ICUSTAYS rows with SUBJECT_ID and HADM_ID", "sql": "SELECT SUBJECT_ID, HADM_ID FROM ICUSTAYS WHERE SUBJECT_ID IS NOT NULL AND ROWNUM <= 100"}
{"question": "Count rows in ICUSTAYS (sampled)", "sql": "SELECT COUNT(*) AS cnt FROM ICUSTAYS WHERE ROWNUM <= 1000"}
{"question": "Show sample INGREDIENTEVENTS rows with SUBJECT_ID and HADM_ID", "sql": "SELECT SUBJECT_ID, HADM_ID FROM INGREDIENTEVENTS WHERE SUBJECT_ID IS NOT NULL AND ROWNUM <= 100"}
{"question": "Count rows in INGREDIENTEVENTS (sampled)", "sql": "SELECT COUNT(*) AS cnt FROM INGREDIENTEVENTS WHERE ROWNUM <= 1000"}
{"question": "Show sample INPUTEVENTS rows with SUBJECT_ID and HADM_ID", "sql": "SELECT SUBJECT_ID, HADM_ID FROM INPUTEVENTS WHERE SUBJECT_ID IS NOT NULL AND ROWNUM <= 100"}
{"question": "Count rows in INPUTEVENTS (sampled)", "sql": "SELECT COUNT(*) AS cnt FROM INPUTEVENTS WHERE ROWNUM <= 1000"}
{"question": "Show sample LABEVENTS rows with LABEVENT_ID and SUBJECT_ID", "sql": "SELECT LABEVENT_ID, SUBJECT_ID FROM LABEVENTS WHERE LABEVENT_ID IS NOT NULL AND ROWNUM <= 100"}
{"question": "Count rows in LABEVENTS (sampled)", "sql": "SELECT COUNT(*) AS cnt FROM LABEVENTS WHERE ROWNUM <= 1000"}
{"question": "Show sample MICROBIOLOGYEVENTS rows with MICROEVENT_ID and SUBJECT_ID", "sql": "SELECT MICROEVENT_ID, SUBJECT_ID FROM MICROBIOLOGYEVENTS WHERE MICROEVENT_ID IS NOT NULL AND ROWNUM <= 100"}
{"question": "Count rows in MICROBIOLOGYEVENTS (sampled)", "sql": "SELECT COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE ROWNUM <= 1000"}
{"question": "Show sample OUTPUTEVENTS rows with SUBJECT_ID and HADM_ID", "sql": "SELECT SUBJECT_ID, HADM_ID FROM OUTPUTEVENTS WHERE SUBJECT_ID IS NOT NULL AND ROWNUM <= 100"}
{"question": "Count rows in OUTPUTEVENTS (sampled)", "sql": "SELECT COUNT(*) AS cnt FROM OUTPUTEVENTS WHERE ROWNUM <= 1000"}
{"question": "Show sample PATIENTS rows with SUBJECT_ID and GENDER", "sql": "SELECT SUBJECT_ID, GENDER FROM PATIENTS WHERE SUBJECT_ID IS NOT NULL AND ROWNUM <= 100"}
{"question": "Count rows in PATIENTS (sampled)", "sql": "SELECT COUNT(*) AS cnt FROM PATIENTS WHERE ROWNUM <= 1000"}
{"question": "Show sample POE rows with POE_ID and POE_SEQ", "sql": "SELECT POE_ID, POE_SEQ FROM POE WHERE POE_ID IS NOT NULL AND ROWNUM <= 100"}
{"question": "Count rows in POE (sampled)", "sql": "SELECT COUNT(*) AS cnt FROM POE WHERE ROWNUM <= 1000"}
{"question": "Show sample PRESCRIPTIONS rows with SUBJECT_ID and HADM_ID", "sql": "SELECT SUBJECT_ID, HADM_ID FROM PRESCRIPTIONS WHERE SUBJECT_ID IS NOT NULL AND ROWNUM <= 100"}
{"question": "Count rows in PRESCRIPTIONS (sampled)", "sql": "SELECT COUNT(*) AS cnt FROM PRESCRIPTIONS WHERE ROWNUM <= 1000"}
{"question": "Show sample PROCEDUREEVENTS rows with SUBJECT_ID and HADM_ID", "sql": "SELECT SUBJECT_ID, HADM_ID FROM PROCEDUREEVENTS WHERE SUBJECT_ID IS NOT NULL AND ROWNUM <= 100"}
{"question": "Count rows in PROCEDUREEVENTS (sampled)", "sql": "SELECT COUNT(*) AS cnt FROM PROCEDUREEVENTS WHERE ROWNUM <= 1000"}
{"question": "Show sample PROCEDURES_ICD rows with SUBJECT_ID and HADM_ID", "sql": "SELECT SUBJECT_ID, HADM_ID FROM PROCEDURES_ICD WHERE SUBJECT_ID IS NOT NULL AND ROWNUM <= 100"}
{"question": "Count rows in PROCEDURES_ICD (sampled)", "sql": "SELECT COUNT(*) AS cnt FROM PROCEDURES_ICD WHERE ROWNUM <= 1000"}
{"question": "Show sample SERVICES rows with SUBJECT_ID and HADM_ID", "sql": "SELECT SUBJECT_ID, HADM_ID FROM SERVICES WHERE SUBJECT_ID IS NOT NULL AND ROWNUM <= 100"}
{"question": "Count rows in SERVICES (sampled)", "sql": "SELECT COUNT(*) AS cnt FROM SERVICES WHERE ROWNUM <= 1000"}
{"question": "Show sample TRANSFERS rows with SUBJECT_ID and HADM_ID", "sql": "SELECT SUBJECT_ID, HADM_ID FROM TRANSFERS WHERE SUBJECT_ID IS NOT NULL AND ROWNUM <= 100"}
{"question": "Count rows in TRANSFERS (sampled)", "sql": "SELECT COUNT(*) AS cnt FROM TRANSFERS WHERE ROWNUM <= 1000"}
{"question": "Count admissions with an ICU stay", "sql": "SELECT COUNT(*) AS cnt FROM ADMISSIONS a JOIN ICUSTAYS i ON a.SUBJECT_ID = i.SUBJECT_ID AND a.HADM_ID = i.HADM_ID WHERE a.HADM_ID IS NOT NULL"}
{"question": "Average ICU LOS by first careunit", "sql": "SELECT FIRST_CAREUNIT, AVG(LOS) AS avg_los FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL AND LOS IS NOT NULL GROUP BY FIRST_CAREUNIT"}
{"question": "Count ICU stays by first careunit", "sql": "SELECT FIRST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL GROUP BY FIRST_CAREUNIT ORDER BY cnt DESC"}
{"question": "Count ICU stays by last careunit", "sql": "SELECT LAST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE LAST_CAREUNIT IS NOT NULL GROUP BY LAST_CAREUNIT ORDER BY cnt DESC"}
{"question": "Count chart events by warning flag", "sql": "SELECT WARNING, COUNT(*) AS cnt FROM CHARTEVENTS WHERE WARNING IS NOT NULL GROUP BY WARNING ORDER BY cnt DESC"}
{"question": "Top 10 chart event labels by count", "sql": "SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM CHARTEVENTS c JOIN D_ITEMS d ON c.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10"}
{"question": "Count lab events by flag", "sql": "SELECT FLAG, COUNT(*) AS cnt FROM LABEVENTS WHERE FLAG IS NOT NULL GROUP BY FLAG ORDER BY cnt DESC"}
{"question": "Count lab events by priority", "sql": "SELECT PRIORITY, COUNT(*) AS cnt FROM LABEVENTS WHERE PRIORITY IS NOT NULL GROUP BY PRIORITY ORDER BY cnt DESC"}
{"question": "Top 10 lab item labels by count", "sql": "SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM LABEVENTS l JOIN D_LABITEMS d ON l.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10"}
{"question": "Top 10 microbiology tests by count", "sql": "SELECT * FROM (SELECT TEST_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE TEST_NAME IS NOT NULL GROUP BY TEST_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10"}
{"question": "Top 10 organisms by count", "sql": "SELECT * FROM (SELECT ORG_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE ORG_NAME IS NOT NULL GROUP BY ORG_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10"}
{"question": "Top 10 antibiotics by count", "sql": "SELECT * FROM (SELECT AB_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE AB_NAME IS NOT NULL GROUP BY AB_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10"}
{"question": "Count services by current service", "sql": "SELECT CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE CURR_SERVICE IS NOT NULL GROUP BY CURR_SERVICE ORDER BY cnt DESC"}
{"question": "Top 10 service transitions by count", "sql": "SELECT * FROM (SELECT PREV_SERVICE, CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE PREV_SERVICE IS NOT NULL AND CURR_SERVICE IS NOT NULL GROUP BY PREV_SERVICE, CURR_SERVICE ORDER BY cnt DESC) WHERE ROWNUM <= 10"}
{"question": "Average anchor age by gender", "sql": "SELECT GENDER, AVG(ANCHOR_AGE) AS avg_age FROM PATIENTS WHERE GENDER IS NOT NULL AND ANCHOR_AGE IS NOT NULL GROUP BY GENDER"}
{"question": "Count patients by anchor year group", "sql": "SELECT ANCHOR_YEAR_GROUP, COUNT(*) AS cnt FROM PATIENTS WHERE ANCHOR_YEAR_GROUP IS NOT NULL GROUP BY ANCHOR_YEAR_GROUP ORDER BY cnt DESC"}
{"question": "For my 89-year-old male: among men 84-94, what's the maximum number of distinct echocardiography procedures per patient during hospitalization?", "sql": "SELECT MAX(procedure_count) as max_echo_procedures FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) as procedure_count FROM PATIENTS p JOIN PROCEDURES_ICD pr ON p.subject_id = pr.subject_id WHERE p.gender = 'M' AND p.anchor_age BETWEEN 84 AND 94 AND ( (pr.icd_version = 10 AND pr.icd_code LIKE 'B24%') OR (pr.icd_version = 9 AND pr.icd_code = '8872') ) GROUP BY p.subject_id ) patient_procedures;"}
{"question": "I have an 85-year-old male. Among men 80-90, what's the maximum distinct mechanical circulatory support procedures per hospitalized patient?", "sql": "SELECT MAX(procedure_count) AS max_mechanical_circulatory_support_count FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) AS procedure_count FROM PATIENTS AS p JOIN PROCEDURES_ICD AS pr ON p.subject_id = pr.subject_id WHERE p.gender = 'M' AND p.anchor_age BETWEEN 80 AND 90 AND ( (pr.icd_version = 9 AND pr.icd_code LIKE '37.6%') OR (pr.icd_version = 10 AND ( pr.icd_code LIKE '5A02%' OR pr.icd_code LIKE '02HL%' )) ) GROUP BY p.subject_id ) AS patient_procedure_counts;"}
{"question": "I have an 86-year-old man. Among males 81-91, what's the SD of distinct ECG/telemetry procedure codes per patient during hospitalization?", "sql": "SELECT ROUND(STDDEV(procedure_count), 2) AS stddev_ecg_telemetry_procedures FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) AS procedure_count FROM PATIENTS p JOIN PROCEDURES_ICD pr ON p.subject_id = pr.subject_id WHERE p.gender = 'M' AND p.anchor_age BETWEEN 81 AND 91 AND pr.icd_code IS NOT NULL AND pr.icd_version IS NOT NULL AND ( (pr.icd_version = 9 AND ( pr.icd_code = '89.52' OR pr.icd_code = '89.54' )) OR (pr.icd_version = 10 AND ( pr.icd_code LIKE '4A02%' OR pr.icd_code LIKE '4A12%' )) ) GROUP BY p.subject_id ) patient_procedures;"}
{"question": "I have a 46-year-old female. Among females 41-51, what is the standard deviation of distinct CABG procedures per patient?", "sql": "SELECT ROUND(STDDEV(procedure_count), 2) as stddev_cabg_procedures FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) as procedure_count FROM PATIENTS p JOIN PROCEDURES_ICD pr ON p.subject_id = pr.subject_id WHERE p.gender = 'F' AND p.anchor_age BETWEEN 41 AND 51 AND ( (pr.icd_version = 9 AND pr.icd_code LIKE '36.1%') OR (pr.icd_version = 10 AND pr.icd_code LIKE '021%') ) GROUP BY p.subject_id ) patient_procedures;"}
{"question": "I have a 62-year-old woman; among female patients aged 57-67, what's the minimum distinct valve repair/replacement procedures per hospitalization?", "sql": "SELECT MIN(procedure_count) AS min_valve_procedures FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) AS procedure_count FROM PATIENTS AS p INNER JOIN PROCEDURES_ICD AS pr ON p.subject_id = pr.subject_id WHERE p.gender = 'F' AND p.anchor_age BETWEEN 57 AND 67 AND pr.icd_code IS NOT NULL AND ( (pr.icd_version = 9 AND ( pr.icd_code LIKE '35.1%' OR pr.icd_code LIKE '35.2%' OR pr.icd_code = '35.05' OR pr.icd_code = '35.06' OR pr.icd_code = '35.07' OR pr.icd_code = '35.08' OR pr.icd_code = '35.96' )) OR (pr.icd_version = 10 AND ( pr.icd_code LIKE '02RF%' OR pr.icd_code LIKE '02UF%' )) ) GROUP BY p.subject_id ) AS patient_procedures;"}
{"question": "For my 91-year-old male, among men 86-96, what is the SD of distinct catheter ablation or cardioversion procedures per patient?", "sql": "SELECT ROUND(STDDEV(procedure_count), 2) AS stddev_procedure_count FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) AS procedure_count FROM PATIENTS AS p LEFT JOIN PROCEDURES_ICD AS pr ON p.subject_id = pr.subject_id AND ( (pr.icd_version = 9 AND ( pr.icd_code = '37.34' OR pr.icd_code LIKE '99.6%' )) OR (pr.icd_version = 10 AND ( pr.icd_code LIKE '025%' OR pr.icd_code LIKE '5A22%' )) ) WHERE p.gender = 'M' AND p.anchor_age BETWEEN 86 AND 96 GROUP BY p.subject_id ) AS patient_procedures;"}
{"question": "In male patients aged 82-92, what is the minimum number of distinct pacemaker or ICD implantation procedures per hospitalization?", "sql": "SELECT MIN(procedure_count) as min_pacemaker_or_icd_implantations FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) as procedure_count FROM PATIENTS AS p JOIN PROCEDURES_ICD AS pr ON p.subject_id = pr.subject_id WHERE p.gender = 'M' AND p.anchor_age BETWEEN 82 AND 92 AND ( (pr.icd_version = 9 AND ( pr.icd_code LIKE '37.8%' OR pr.icd_code = '37.94' OR pr.icd_code = '37.95' OR pr.icd_code = '37.96' )) OR (pr.icd_version = 10 AND ( pr.icd_code LIKE '0JH6%' OR pr.icd_code LIKE '0JH8%' OR pr.icd_code LIKE '0JHT%' OR pr.icd_code LIKE '0JHW%' )) ) GROUP BY p.subject_id ) AS patient_procedures;"}
{"question": "For a 45-year-old female, among women aged 40-50, what's the minimum number of distinct mechanical circulatory support procedures per patient?", "sql": "SELECT MIN(procedure_count) as min_mechanical_circulatory_support FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) as procedure_count FROM PATIENTS p JOIN PROCEDURES_ICD pr ON p.subject_id = pr.subject_id WHERE p.gender = 'F' AND p.anchor_age BETWEEN 40 AND 50 AND ( (pr.icd_version = 10 AND ( pr.icd_code LIKE '5A0%' OR pr.icd_code LIKE '5A1%' )) OR (pr.icd_version = 9 AND ( pr.icd_code LIKE '37.6%' OR pr.icd_code = '39.65' )) ) GROUP BY p.subject_id ) AS patient_procedure_counts;"}
{"question": "For my 47-year-old male, among males aged 42-52 who had valve repair/replacement, what is the average distinct valve procedures per patient?", "sql": "SELECT ROUND(AVG(procedure_count), 2) AS avg_valve_procedures FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) AS procedure_count FROM PATIENTS AS p JOIN PROCEDURES_ICD AS pr ON p.subject_id = pr.subject_id WHERE p.gender = 'M' AND p.anchor_age BETWEEN 42 AND 52 AND ( (pr.icd_version = 9 AND ( pr.icd_code LIKE '35.1%' OR pr.icd_code LIKE '35.2%' OR pr.icd_code IN ('35.05', '35.06', '35.07', '35.08') )) OR (pr.icd_version = 10 AND SUBSTR(pr.icd_code, 1, 4) IN ( '02PF', '02PG', '02PH', '02PJ', '02RF', '02RG', '02RH', '02RJ' ) ) ) GROUP BY p.subject_id ) AS patient_procedures;"}
{"question": "For my 61-year-old male patient, among males 56-66, what is SD of distinct mechanical circulatory support procedures per patient?", "sql": "SELECT ROUND(STDDEV(procedure_count), 2) as stddev_mech_circ_support_procedures FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) as procedure_count FROM PATIENTS p JOIN PROCEDURES_ICD pr ON p.subject_id = pr.subject_id WHERE p.gender = 'M' AND p.anchor_age BETWEEN 56 AND 66 AND pr.icd_code IS NOT NULL AND ( (pr.icd_version = 9 AND ( pr.icd_code LIKE '37.6%' )) OR (pr.icd_version = 10 AND ( pr.icd_code LIKE '5A02%' OR pr.icd_code LIKE '5A1522%' )) ) GROUP BY p.subject_id ) patient_procedures;"}
{"question": "For my 42-year-old male, among men 37-47, what's the SD of distinct catheter ablation or cardioversion procedures during hospitalization?", "sql": "SELECT ROUND(STDDEV(procedure_count), 2) as stddev_procedure_count FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) as procedure_count FROM PATIENTS p JOIN PROCEDURES_ICD pr ON p.subject_id = pr.subject_id WHERE p.gender = 'M' AND p.anchor_age BETWEEN 37 AND 47 AND ( (pr.icd_version = 9 AND pr.icd_code IN ( '99.60', '99.61', '99.62', '99.69', '37.34' )) OR (pr.icd_version = 10 AND ( pr.icd_code LIKE '5A22%' OR pr.icd_code LIKE '0258%' )) ) GROUP BY p.subject_id ) patient_procedures;"}
{"question": "For my 86-year-old female, among females 81-91, what's the maximum number of distinct echocardiography procedures per patient during hospitalization?", "sql": "SELECT MAX(procedure_count) AS max_distinct_echo_procedures FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) AS procedure_count FROM PATIENTS AS p JOIN PROCEDURES_ICD AS pr ON p.subject_id = pr.subject_id WHERE p.gender = 'F' AND p.anchor_age BETWEEN 81 AND 91 AND ( (pr.icd_version = 9 AND pr.icd_code = '88.72') OR (pr.icd_version = 10 AND pr.icd_code LIKE 'B21%') ) GROUP BY p.subject_id ) AS patient_procedures;"}
